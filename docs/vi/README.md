Mobiletto
 =========

 Mobiletto lÃ  má»™t lá»›p trá»«u tÆ°á»£ng lÆ°u trá»¯ JavaScript, vá»›i mÃ£ hÃ³a phÃ­a mÃ¡y khÃ¡ch trong suá»‘t tÃ¹y chá»n.

 # Ná»™i dung
 * [Táº¡i sao láº¡i lÃ  Mobiletto?](# Táº¡i sao-Mobiletto?)
 * [Báº¯t Ä‘áº§u nhanh](# Báº¯t Ä‘áº§u nhanh)
 * [Mobiletto CLI](# mobiletto-cli)
 * [Nguá»“n](# Nguá»“n)
 * [CÃ i Ä‘áº·t](# CÃ i Ä‘áº·t)
 * [Há»— trá»£ vÃ  TÃ i trá»£](# Há»— trá»£ vÃ  TÃ i trá»£)
 * [CÃ¡ch sá»­ dá»¥ng cÆ¡ báº£n](# CÃ¡ch sá»­ dá»¥ng cÆ¡ báº£n)
 * [SiÃªu dá»¯ liá»‡u](# SiÃªu dá»¯ liá»‡u)
 * [Kiá»ƒu nháº­p thay tháº¿](# Kiá»ƒu nháº­p thay tháº¿)
 * [Bá»™ nhá»› Ä‘á»‡m](# bá»™ nhá»› Ä‘á»‡m)
 * [Pháº£n chiáº¿u](# Pháº£n chiáº¿u)
 * [MÃ£ hÃ³a minh báº¡ch](# MÃ£ hÃ³a minh báº¡ch)
 * [Xoay phÃ­m](# Xoay phÃ­m)
 * [Giao diá»‡n trÃ¬nh Ä‘iá»u khiá»ƒn](# Giao diá»‡n trÃ¬nh Ä‘iá»u khiá»ƒn)
 * [Ghi nháº­t kÃ½](# Ghi nháº­t kÃ½)

 # Äá»c sÃ¡ch nÃ y báº±ng ngÃ´n ngá»¯ khÃ¡c
 TÃ i liá»‡u README.md nÃ y Ä‘Ã£ Ä‘Æ°á»£c dá»‹ch, qua [hokeyption](https://github.com/cobbzilla/hokeyption), sang
 ** [má»i ngÃ´n ngá»¯ Ä‘Æ°á»£c Google Dá»‹ch há»— trá»£](https://cloud.google.com/translate/docs/languages)! **

 TÃ´i cháº¯c cháº¯n ráº±ng nÃ³ khÃ´ng hoÃ n háº£o, nhÆ°ng tÃ´i hy vá»ng nÃ³ cÃ²n hÆ¡n khÃ´ng!

 [ğŸ‡¸ğŸ‡¦ tiáº¿ng áº¢ Ráº­p](docs / ar / README.md)
 [ğŸ‡§ğŸ‡© Tiáº¿ng Bengali](docs / bn / README.md)
 [ğŸ‡©ğŸ‡ª tiáº¿ng Äá»©c](docs / de / README.md)
 [ğŸ‡ºğŸ‡¸ Tiáº¿ng Anh](docs / en / README.md)
 [ğŸ‡ªğŸ‡¸ Tiáº¿ng TÃ¢y Ban Nha](docs / es / README.md)
 [ğŸ‡«ğŸ‡· Tiáº¿ng PhÃ¡p](docs / fr / README.md)
 [ğŸ‡¹ğŸ‡© Hausa](docs / ha / README.md)
 [ğŸ‡®ğŸ‡³ Hindi](docs / hi / README.md)
 [ğŸ‡®ğŸ‡© tiáº¿ng Indonesia](docs / id / README.md)
 [ğŸ‡®ğŸ‡¹ Tiáº¿ng Ã](docs / it / README.md)
 [ğŸ‡¯ğŸ‡µ Tiáº¿ng Nháº­t](docs / ja / README.md)
 [ğŸ‡°ğŸ‡· Tiáº¿ng HÃ n](docs / ko / README.md)
 [ğŸ‡®ğŸ‡³ Marathi](docs / mr / README.md)
 [ğŸ‡µğŸ‡± Tiáº¿ng Ba Lan](docs / pl / README.md)
 [ğŸ‡§ğŸ‡· tiáº¿ng Bá»“ ÄÃ o Nha](docs / pt / README.md)
 [ğŸ‡·ğŸ‡º tiáº¿ng Nga](docs / ru / README.md)
 [ğŸ‡°ğŸ‡ª Swahili](docs / sw / README.md)
 [ğŸ‡µğŸ‡­ Tagalog](docs / tl / README.md)
 [ğŸ‡¹ğŸ‡· tiáº¿ng Thá»• NhÄ© Ká»³](docs / tr / README.md)
 [ğŸ‡µğŸ‡° Urdu](docs / ur / README.md)
 [ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t](docs / vi / README.md)
 [ğŸ‡¨ğŸ‡³ Tiáº¿ng Trung](docs / zh / README.md)


 ** [ğŸ“š ... Táº¥t cáº£ ngÃ´n ngá»¯ ...](docs / README.md) **
 ----

 ### CÃ³ sá»± cá»‘ vá»›i báº£n dá»‹ch README nÃ y khÃ´ng?
 Báº£n dá»‹ch cá»¥ thá»ƒ nÃ y cá»§a báº£n gá»‘c [README](https://github.com/cobbzilla/mobiletto/blob/master/README.md)
 cÃ³ thá»ƒ cÃ³ sai sÃ³t - * ráº¥t hoan nghÃªnh viá»‡c sá»­a chá»¯a! * Vui lÃ²ng gá»­i [yÃªu cáº§u kÃ©o trÃªn GitHub](https://github.com/cobbzilla/mobiletto/pulls),
 hoáº·c náº¿u báº¡n khÃ´ng thoáº£i mÃ¡i khi lÃ m Ä‘iá»u Ä‘Ã³, hÃ£y [má»Ÿ sá»± cá»‘](https://github.com/cobbzilla/mobiletto/issues)

 Khi báº¡n táº¡o má»™t váº¥n Ä‘á» GitHub má»›i vá» báº£n dá»‹ch, vui lÃ²ng thá»±c hiá»‡n:
 * bao gá»“m URL cá»§a trang (sao chÃ©p / dÃ¡n tá»« thanh Ä‘á»‹a chá»‰ trÃ¬nh duyá»‡t)
 * bao gá»“m vÄƒn báº£n chÃ­nh xÃ¡c bá»‹ sai (sao chÃ©p / dÃ¡n tá»« trÃ¬nh duyá»‡t)
 * vui lÃ²ng mÃ´ táº£ nhá»¯ng gÃ¬ lÃ  sai - báº£n dá»‹ch khÃ´ng chÃ­nh xÃ¡c? Ä‘á»‹nh dáº¡ng cÃ³ bá»‹ há»ng báº±ng cÃ¡ch nÃ o Ä‘Ã³ khÃ´ng?
 * vui lÃ²ng Ä‘Æ°a ra gá»£i Ã½ vá» báº£n dá»‹ch tá»‘t hÆ¡n hoáº·c cÃ¡ch vÄƒn báº£n pháº£i Ä‘Æ°á»£c Ä‘á»‹nh dáº¡ng Ä‘Ãºng
 * **Cáº£m Æ¡n báº¡n!**

 ## Táº¡i sao Mobiletto?

 ### Táº¡m biá»‡t khÃ³a cá»­a nhÃ  cung cáº¥p!
 CÃ¡c nhÃ  cung cáº¥p dá»‹ch vá»¥ lÆ°u trá»¯ Ä‘Ã¡m mÃ¢y khÃ¡c nhau cÃ³ cÃ¡c API khÃ´ng tÆ°Æ¡ng thÃ­ch. Ngay cáº£ nhá»¯ng ngÆ°á»i pháº¥n Ä‘áº¥u cho "kháº£ nÄƒng tÆ°Æ¡ng thÃ­ch S3"
 cÃ³ nhá»¯ng hÃ nh vi mang phong cÃ¡ch riÃªng.

 Khi báº¡n chá»n má»™t nhÃ  cung cáº¥p bá»™ nhá»› cá»¥ thá»ƒ cho á»©ng dá»¥ng cá»§a mÃ¬nh, náº¿u báº¡n viáº¿t mÃ£ trá»±c tiáº¿p tá»›i API cá»§a há», á»©ng dá»¥ng cá»§a báº¡n
 bÃ¢y giá» phá»¥ thuá»™c vÃ o dá»‹ch vá»¥ Ä‘Ã³. Khi thá»i gian trÃ´i qua vÃ  mÃ£ tÃ­ch lÅ©y, viá»‡c thay Ä‘á»•i nhÃ  cung cáº¥p sáº½ trá»Ÿ thÃ nh
 ngÃ y cÃ ng khÃ´ng thá»ƒ kiá»ƒm soÃ¡t Ä‘Æ°á»£c. ChÃ o má»«ng báº¡n Ä‘áº¿n vá»›i tháº¿ giá»›i thÃº vá»‹ cá»§a khÃ³a nhÃ  cung cáº¥p!

 Mobiletto Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y. Báº±ng cÃ¡ch mÃ£ hÃ³a á»©ng dá»¥ng cá»§a báº¡n thÃ nh API cá»§a mobiletto, báº¡n cÃ³ thá»ƒ dá»… dÃ ng
 thay Ä‘á»•i nhÃ  cung cáº¥p bá»™ nhá»› vÃ  biáº¿t ráº±ng lá»›p lÆ°u trá»¯ cá»§a á»©ng dá»¥ng cá»§a báº¡n sáº½ hoáº¡t Ä‘á»™ng giá»‘ng há»‡t nhau.

 ### Thá»­ nghiá»‡m rá»™ng rÃ£i
 Táº¥t cáº£ cÃ¡c trÃ¬nh Ä‘iá»u khiá»ƒn Ä‘á»u Ä‘Æ°á»£c kiá»ƒm tra hÃ nh vi giá»‘ng há»‡t nhau vá»›i hÆ¡n 60 bÃ i kiá»ƒm tra cho má»—i trÃ¬nh Ä‘iá»u khiá»ƒn.
 ChÃºng tÃ´i kiá»ƒm tra táº¥t cáº£ cÃ¡c trÃ¬nh Ä‘iá»u khiá»ƒn vá»›i má»i sá»± káº¿t há»£p cá»§a:
 * MÃ£ hÃ³a: cáº£ báº­t vÃ  táº¯t
 * Redis cache: cáº£ Ä‘Æ°á»£c báº­t vÃ  táº¯t

 CÃ¡ch tiáº¿p cáº­n nÃ y giÃºp chÃºng tÃ´i yÃªn tÃ¢m ráº±ng mobiletto sáº½ hoáº¡t Ä‘á»™ng giá»‘ng nhau báº¥t ká»ƒ báº¡n sá»­ dá»¥ng trÃ¬nh Ä‘iá»u khiá»ƒn nÃ o,
 vÃ  báº¥t ká»ƒ báº¡n cÃ³ báº­t bá»™ nhá»› Ä‘á»‡m vÃ  / hoáº·c mÃ£ hÃ³a hay khÃ´ng.

 ### Há»— trá»£ trÃ¬nh Ä‘iá»u khiá»ƒn
 TrÃ¬nh Ä‘iá»u khiá»ƒn lÆ°u trá»¯ Mobiletto hiá»‡n táº¡i:
 * `s3` : Amazon S3
 * `b2` : Backblaze B2
 * `local` : há»‡ thá»‘ng tá»‡p cá»¥c bá»™

 * Ráº¥t hoan nghÃªnh cÃ¡c Ä‘Ã³ng gÃ³p Ä‘á»ƒ há»— trá»£ thÃªm cÃ¡c nhÃ  cung cáº¥p dá»‹ch vá»¥ lÆ°u trá»¯ Ä‘Ã¡m mÃ¢y! *

 ## mobiletto-cli
 Mobiletto dá»± Ä‘á»‹nh sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° má»™t thÆ° viá»‡n báº±ng mÃ£ JavaScript khÃ¡c.

 Äá»ƒ lÃ m viá»‡c vá»›i mobiletto táº¡i dÃ²ng lá»‡nh, hÃ£y sá»­ dá»¥ng [mobiletto-cli](https://www.npmjs.com/package/mobiletto-cli)

 ## Nguá»“n
 * [mobiletto trÃªn GitHub](https://github.com/cobbzilla/mobiletto)
 * [mobiletto trÃªn npm](https://www.npmjs.com/package/mobiletto)

 ## Há»— trá»£ vÃ  TÃ i trá»£
 TÃ´i Ä‘ang cá»‘ gáº¯ng trá»Ÿ thÃ nh má»™t nhÃ  phÃ¡t triá»ƒn pháº§n má»m nguá»“n má»Ÿ chuyÃªn nghiá»‡p. TÃ´i Ä‘Ã£ lÃ m viá»‡c á»Ÿ
 ngÃ nh cÃ´ng nghiá»‡p pháº§n má»m trong nhiá»u nÄƒm, tÃ´i Ä‘Ã£ thÃ nh láº­p cÃ¡c cÃ´ng ty thÃ nh cÃ´ng vÃ  bÃ¡n chÃºng cho cÃ¡c cÃ´ng ty Ä‘áº¡i chÃºng.
 Gáº§n Ä‘Ã¢y, tÃ´i bá»‹ máº¥t viá»‡c vÃ  tÃ´i khÃ´ng thá»±c sá»± cÃ³ báº¥t ká»³ cÃ´ng viá»‡c nÃ o khÃ¡c.

 VÃ¬ váº­y, tÃ´i sáº½ thá»­ viáº¿t pháº§n má»m há»¯u Ã­ch vÃ  xem nÃ³ cÃ³ hoáº¡t Ä‘á»™ng khÃ´ng

 Náº¿u báº¡n thÃ­ch sá»­ dá»¥ng pháº§n má»m nÃ y, tÃ´i sáº½ ráº¥t biáº¿t Æ¡n vÃ¬
 nhá» nháº¥t [Ä‘Ã³ng gÃ³p hÃ ng thÃ¡ng qua Patreon](https://www.patreon.com/cobbzilla)

 *Cáº£m Æ¡n báº¡n!*

 ## CÃ i Ä‘áº·t
 CÃ i Ä‘áº·t báº±ng cÃ¡ch sá»­ dá»¥ng `npm` `yarn` . Báº¡n cÃ³ thá»ƒ muá»‘n phiÃªn báº£n `lite` khÃ´ng bao gá»“m táº¥t cáº£ cÃ¡c
 cÃ¡c tá»‡p README Ä‘Ã£ dá»‹ch:

    npm install mobiletto-lite
    yarn add mobiletto-lite

 Náº¿u báº¡n thá»±c sá»± muá»‘n cÃ¡c tá»‡p README á»Ÿ má»i ngÃ´n ngá»¯, hÃ£y cÃ i Ä‘áº·t phiÃªn báº£n Ä‘áº§y Ä‘á»§:

    npm install mobiletto
    yarn add mobiletto

 ## Báº¯t Ä‘áº§u nhanh
 Má»™t vÃ­ dá»¥ ngáº¯n sá»­ dá»¥ng trÃ¬nh Ä‘iá»u khiá»ƒn `s3` .

 MÃ£ nÃ y sáº½ cháº¡y tÆ°Æ¡ng tá»± náº¿u trÃ¬nh Ä‘iá»u khiá»ƒn lÃ  `b2` `local` .

    const storage = require('mobiletto')
    const bucket = await storage.connect('s3', aws_key, aws_secret, {bucket: 'bk'})

    // list objects: returns array of metadata objects
    const listing = await bucket.list()
    const dirList = await bucket.list('some/dir/')
    const everything = await bucket.list('', {recursive: true})

    // write an entire file
    let bytesWritten = await bucket.writeFile('some/path', someBufferOfData)

    // write a file from a stream/generator
    bytesWritten = await bucket.write('some/path', streamOrGenerator)

    // read an entire file
    // returns null if an exception would otherwise be thrown
    const bufferOrNull = await bucket.safeReadFile('some/path')

    // stream-read a file, passing data to callback
    const bytesRead = await bucket.read('some/path', (chunk) => { ...do something with chunk... } )

    // remove a file, returns the path removed
    let removed = await bucket.remove('some/path') // removed is a string

    // remove a directory, returns array of paths removed
    removed = await bucket.remove('some/directory', {recursive: true}) // removed is now an array!

 ----
 ## CÃ¡ch sá»­ dá»¥ng cÆ¡ báº£n
 Má»™t vÃ­ dá»¥ rá»™ng hÆ¡n nhiá»u, hiá»ƒn thá»‹ háº§u háº¿t cÃ¡c tÃ­nh nÄƒng Ä‘Æ°á»£c cung cáº¥p:

    const { mobiletto } = require('mobiletto')

    // General usage
    const api = await mobiletto(driverName, key, secret, opts)

    // To use 'local' driver:
    // * key: base directory
    // * secret: ignored, can be null
    // * opts object:
    // * readOnly: optional, never change anything on the filesystem; default is false
    // * fileMode: optional, permissions used when creating new files, default is 0600. can be string or integer
    // * dirMode: optional, permissions used when creating new directories, default is 0700. can be string or integer
    const local = await mobiletto('local', '/home/ubuntu/tmp', null, {fileMode: 0o0600, dirMode: '0700'})

    // To use 's3' driver:
    // * key: AWS Access Key ID
    // * secret: AWS Secret Key
    // * opts object:
    // * readOnly: optional, never change anything on the bucket; default is false
    // * bucket: required, name of the S3 bucket
    // * region: optional, the AWS region to communicate with, default is us-east-1
    // * prefix: optional, all read/writes within the S3 bucket will be under this prefix
    // * delimiter: optional, directory delimiter, default is '/' (note: always '/' when encryption is enabled)
    const s3 = await mobiletto('s3', aws_key, aws_secret, {bucket: 'bk', region: 'us-east-1'})

    // To use 'b2' driver:
    // * key: Backblaze Key ID
    // * secret: Backblaze Application Key
    // * opts object:
    // * readOnly: optional, never change anything on the bucket; default is false
    // * bucket: required, the ID (**not the name**) of the B2 bucket
    // * prefix: optional, all read/writes within the B2 bucket will be under this prefix
    // * delimiter: optional, directory delimiter, default is '/' (note: always '/' when encryption is enabled)
    // * partSize: optional, large files will be split into chunks of this size when uploading
    const b3 = await mobiletto('b2', b2_key_id, b2_app_key, {bucket: 'bk', partSize: 10000000})

    // List files
    api.list() // --> returns an array of metadata objects

    // List files recursively
    api.list({ recursive: true })

    // List files in a directory
    const path = 'some/path'
    api.list(path)
    api.list(path, { recursive: true }) // also supports recursive flag

    // Visit files in a directory -- visitor function must be async
    api.list(path, { visitor: myAsyncFunc })
    api.list(path, { visitor: myAsyncFunc, recursive: true })

    // The `list` method throws MobilettoNotFoundError if the path does not exist
    // When you call `safeList` on a non-existent path, it returns an empty array
    api.safeList('/path/that/does/not/exist') // returns []
    
    // Read metadata for a file
    api.metadata(path) // returns metadata object

    // The `metadata` method throws MobilettoNotFoundError if the path does not exist
    // When you call `safeMetadata` on a non-existent path, it returns null
    api.safeMetadata('/tmp/does_not_exist') // returns null
    
    // Read a file
    // Provide a callback that writes the data someplace
    const callback = (chunk) => { ... write chunk somewhere ... }
    api.read(path, callback) // returns count of bytes read

    // Read an entire file at once
    const data = await api.readFile(path) // returns a byte Buffer of the file contents
    
    // Read an entire file at once
    // returns null if an exception would otherwise be thrown
    const bufferOrNull = await bucket.safeReadFile('some/path')

    // Write a file
    // Provide a generator function that yields chunks of data
    const generator = function* () {
      while ( ... more-data-to-return ... ) {
        data = ... load-data ...
        yield data
      }
    }
    local.api(path, generator) // returns count of bytes written

    // Write an entire file at once (convenience method)
    await api.writeFile(path, bufferOrString) // returns count of bytes written

    // Delete a file
    // Quiet param is optional (default false), when set errors will not be thrown if the path does not exist
    // Always returns a value or throws an error.
    // Return value may be a single string of the file removed, or an array of all files removed (driver-dependent)
    const quiet = true
    api.remove(path, {quiet}) // returns single path removed

    // Recursively delete a directory and do it quietly (do not report errors)
    const recursive = true
    const quiet = true
    api.remove(path, {recursive, quiet}) // returns array of paths removed

 ## Metadata
 Lá»‡nh `metadata` tráº£ vá» siÃªu dá»¯ liá»‡u vá» má»™t má»¥c nháº­p há»‡ thá»‘ng tá»‡p.
 TÆ°Æ¡ng tá»± nhÆ° váº­y, giÃ¡ trá»‹ tráº£ vá» tá»« lá»‡nh `list` lÃ  má»™t máº£ng cÃ¡c Ä‘á»‘i tÆ°á»£ng siÃªu dá»¯ liá»‡u.

 Má»™t Ä‘á»‘i tÆ°á»£ng siÃªu dá»¯ liá»‡u trÃ´ng giá»‘ng nhÆ° sau:

    {
      "name": "fully/qualified/path/to/file",
      "type": "entry-type",
      "size": size-in-bytes,
      "ctime": creation-time-epoch-millis,
      "mtime": modification-time-epoch-millis
    }

 Thuá»™c tÃ­nh `type` cÃ³ thá»ƒ `file` , `dir` , `link` hoáº·c `special` .

 TÃ¹y thuá»™c vÃ o loáº¡i trÃ¬nh Ä‘iá»u khiá»ƒn, lá»‡nh `list` cÃ³ thá»ƒ khÃ´ng tráº£ vá» táº¥t cáº£ cÃ¡c trÆ°á»ng. Thuá»™c tÃ­nh `name` `type`
 nÃªn luÃ´n luÃ´n cÃ³ máº·t. Lá»‡nh `metadata` tiáº¿p theo sáº½ tráº£ vá» táº¥t cáº£ cÃ¡c thuá»™c tÃ­nh cÃ³ sáºµn.

 ## Kiá»ƒu nháº­p thay tháº¿
 Nháº­p mÃ´-Ä‘un cÃ³ pháº¡m vi Ä‘áº§y Ä‘á»§ vÃ  sá»­ dá»¥ng chá»©c nÄƒng `connect` :

    const storage = require('mobiletto')
    const opts = {bucket: 'bk', region: 'us-east-1'}
    const s3 = await storage.connect('s3', aws_key, aws_secret, opts)
    const objectData = await s3.readFile('some/path')

 ## Bá»™ nhá»› Ä‘á»‡m
 Mobiletto hoáº¡t Ä‘á»™ng tá»‘t nháº¥t vá»›i bá»™ nhá»› Ä‘á»‡m <a href="https://redis.io">redis</a> .

 Mobiletto sáº½ cá»‘ gáº¯ng káº¿t ná»‘i vá»›i phiÃªn báº£n redis trÃªn 127.0.0.1:6379

 Báº¡n cÃ³ thá»ƒ ghi Ä‘Ã¨ má»™t trong hai cÃ¡ch sau:
 * Äáº·t env var cá»§a `MOBILETTO_REDIS_HOST` , mobiletto Ä‘á»ƒ káº¿t ná»‘i táº¡i Ä‘Ã¢y thay vÃ¬ localhost
 * Äáº·t var env `MOBILETTO_REDIS_PORT` , cá»•ng nÃ y sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng

 Mobiletto sáº½ lÆ°u trá»¯ táº¥t cáº£ cÃ¡c khÃ³a redis cá»§a mÃ¬nh vá»›i tiá»n tá»‘ `_mobiletto__` . Báº¡n cÃ³ thá»ƒ thay Ä‘á»•i Ä‘iá»u nÃ y
 báº±ng cÃ¡ch Ä‘áº·t var env `MOBILETTO_REDIS_PREFIX` .

 Báº¡n cÅ©ng cÃ³ thá»ƒ Ä‘áº·t bá»™ nhá»› Ä‘á»‡m cho má»—i káº¿t ná»‘i báº±ng Ä‘á»‘i tÆ°á»£ng `opts.redisConfig` :

    const redisConfig = {
        enabled: true, // optional, default is true. if false other props are ignored
        host: '127.0.0.1',
        port: 6379,
        prefix: '_mobiletto__'
    }
    const opts = { redisConfig, bucket: 'bk', region: 'us-east-1' }
    const s3 = await storage.connect('s3', aws_key, aws_secret, opts)

 ### Báº¡n khÃ´ng muá»‘n redis vÃ o bá»™ nhá»› Ä‘á»‡m?
 Äá»ƒ vÃ´ hiá»‡u hÃ³a: hÃ£y truyá»n `enabled: false` vÃ o Ä‘á»‘i `opts.redisConfig` cá»§a báº¡n khi báº¡n thiáº¿t láº­p káº¿t ná»‘i cá»§a mÃ¬nh.

 NhÆ° Ä‘Ã£ tháº£o luáº­n bÃªn dÆ°á»›i, viá»‡c táº¯t bá»™ nhá»› Ä‘á»‡m sáº½ cÃ³ áº£nh hÆ°á»Ÿng xáº¥u Ä‘áº¿n hiá»‡u suáº¥t vÃ  lÃ m phÃ¡t sinh nhiá»u yÃªu cáº§u hÆ¡n
 vÃ o bá»™ nhá»› mÃ  báº¡n thá»±c sá»± cáº§n.

 ### HÆ°á»›ng dáº«n lÆ°u vÃ o bá»™ nhá»› Ä‘á»‡m
 ** Bá»™ nhá»› Ä‘Æ°á»£c mÃ£ hÃ³a **: bá»™ nhá»› Ä‘Æ°á»£c mÃ£ hÃ³a Ä‘á»c / ghi chá»‰ cháº­m hÆ¡n má»™t chÃºt so vá»›i bÃ¬nh thÆ°á»ng,
 nhÆ°ng viá»‡c Ä‘iá»u hÆ°á»›ng xung quanh cÃ¡c thÆ° má»¥c (má»™t sá»‘ thá»© lÃ m Ä‘Æ°á»£c) khÃ¡ tá»‘n kÃ©m. Sá»­ dá»¥ng bá»™ nhá»› Ä‘á»‡m redis
 sáº½ giÃºp báº¡n tÄƒng hiá»‡u suáº¥t Ä‘Ã¡ng ká»ƒ.

 Bá»™ nhá»› Ä‘á»‡m máº·c Ä‘á»‹nh lÃ  an toÃ n, nhÆ°ng khÃ´ng hoáº¡t Ä‘á»™ng tá»‘t náº¿u báº¡n cÃ³ nhiá»u thao tÃ¡c ghi / xÃ³a.
 Báº¥t ká»³ thao tÃ¡c ghi hoáº·c xÃ³a nÃ o Ä‘á»u lÃ m máº¥t hiá»‡u lá»±c cá»§a toÃ n bá»™ bá»™ nhá»› cache, Ä‘áº£m báº£o cÃ¡c láº§n Ä‘á»c tiáº¿p theo sáº½ tháº¥y
 nhá»¯ng thay Ä‘á»•i má»›i nháº¥t.

 ### CÃ´ng cá»¥ CLI
 Náº¿u báº¡n Ä‘ang sá»­ dá»¥ng cÃ´ng cá»¥ CLI nhÆ° [mobiletto-cli](https://www.npmjs.com/package/mobiletto-cli),
 cháº¯c cháº¯n báº¡n sáº½ muá»‘n kÃ­ch hoáº¡t bá»™ nhá»› cache redis, vÃ¬ nÃ³ tá»“n táº¡i trÃªn cÃ¡c lá»‡nh gá»i cá»§a lá»‡nh `mo` .

 ## Pháº£n chiáº¿u

    // Copy a local filesystem mobiletto to S3
    s3.mirror(local)

    // Mirror a local subdirectory from one mobiletto to an S3 mobiletto, with it's own subdirectory
    local.mirror(s3, 'some/local-folder', 'some/s3-folder')

 Lá»‡nh `mirror` thá»±c hiá»‡n sao chÃ©p má»™t láº§n táº¥t cáº£ cÃ¡c tá»‡p tá»« mobiletto nÃ y sang mobiletto khÃ¡c.
 NÃ³ khÃ´ng cháº¡y báº¥t ká»³ quy trÃ¬nh nÃ o Ä‘á»ƒ duy trÃ¬ gÆ°Æ¡ng theo thá»i gian. Cháº¡y láº¡i lá»‡nh `mirror`
 Ä‘á»ƒ Ä‘á»“ng bá»™ hÃ³a báº¥t ká»³ tá»‡p nÃ o bá»‹ thiáº¿u.

 GiÃ¡ trá»‹ tráº£ vá» tá»« `mirror` lÃ  má»™t Ä‘á»‘i tÆ°á»£ng Ä‘Æ¡n giáº£n cÃ³ bá»™ Ä‘áº¿m cho sá»‘ lÆ°á»£ng tá»‡p Ä‘Ã£ Ä‘Æ°á»£c thÃ nh cÃ´ng
 Ä‘Æ°á»£c pháº£n chiáº¿u vÃ  cÃ³ bao nhiÃªu tá»‡p cÃ³ lá»—i:

    {
      success: count-of-files-mirrored,
      errors: count-of-files-with-errors
    }

 Cáº¢NH BÃO: Sao chÃ©p cÃ¡c táº­p dá»¯ liá»‡u lá»›n cÃ³ thá»ƒ ráº¥t tá»‘n thá»i gian vÃ  bÄƒng thÃ´ng

 Vá»›i ngá»¯ nghÄ©a cuá»™c gá»i `mirror` , Ä‘Ã´i khi cÃ³ thá»ƒ khÃ³ hiá»ƒu Ä‘á»ƒ hiá»ƒu ai lÃ 
 ngÆ°á»i Ä‘á»c vÃ  ngÆ°á»i viáº¿t. HÃ£y tÆ°á»Ÿng tÆ°á»£ng nÃ³ giá»‘ng nhÆ° má»™t cÃ¢u lá»‡nh gÃ¡n: "mobiletto bÃªn trÃ¡i"
 lÃ  thá»© Ä‘Æ°á»£c gÃ¡n cho (dá»¯ liá»‡u Ä‘Æ°á»£c pháº£n chiáº¿u Ä‘Æ°á»£c ghi) vÃ  "mobiletto bÃªn pháº£i" (
 Ä‘á»‘i sá»‘ cho phÆ°Æ¡ng thá»©c `mirror` ) lÃ  giÃ¡ trá»‹ Ä‘ang Ä‘Æ°á»£c gÃ¡n (dá»¯ liá»‡u Ä‘Æ°á»£c nhÃ¢n báº£n Ä‘Æ°á»£c Ä‘á»c).

 ## MÃ£ hÃ³a minh báº¡ch
 Báº­t mÃ£ hÃ³a phÃ­a mÃ¡y khÃ¡ch minh báº¡ch:

    // Pass encryption parameters
    const encryption = {
      // key is required, must be >= 16 chars
      key: randomstring.generate(128),

      // optional, the default is to derive IV from key
      // when set, IV must be >= 16 chars
      iv: randomstring.generate(128),

      // optional, the default is aes-256-cbc
      algo: 'aes-256-cbc'
    }
    const api = await mobiletto(driverName, key, secret, opts, encryption)

    // Subsequent write operations will encrypt data (client side) when writing
    // Subsequent read operations will decrypt data (client side) when reading

 Chuyá»‡n gÃ¬ Ä‘ang xáº£y ra váº­y? ThÆ° má»¥c "má»¥c nháº­p thÆ° má»¥c" (chá»‰ thá»‹) riÃªng biá»‡t (Ä‘Æ°á»£c mÃ£ hÃ³a) theo dÃµi nhá»¯ng tá»‡p nÃ o cÃ³ trong Ä‘Ã³
 thÆ° má»¥c (hay cÃ²n gá»i lÃ  thÆ° má»¥c chá»‰ thá»‹).
 * Lá»‡nh `list` Ä‘á»c cÃ¡c tá»‡p má»¥c nháº­p thÆ° má»¥c, giáº£i mÃ£ tá»«ng Ä‘Æ°á»ng dáº«n Ä‘Æ°á»£c liá»‡t kÃª; sau Ä‘Ã³ tráº£ vá» siÃªu dá»¯ liá»‡u cho tá»«ng tá»‡p
 CÃ¡c lá»‡nh * `list` khÃ´ng hiá»‡u quáº£ hÆ¡n, Ä‘áº·c biá»‡t lÃ  Ä‘á»‘i vá»›i cÃ¡c thÆ° má»¥c cÃ³ sá»‘ lÆ°á»£ng tá»‡p lá»›n
 * Lá»‡nh `write` ghi cÃ¡c tá»‡p chá»‰ thá»‹ trong má»—i thÆ° má»¥c lá»‡nh cá»§a cha, má»™t cÃ¡ch Ä‘á»‡ quy; sau Ä‘Ã³ ghi tá»‡p
 * CÃ¡c lá»‡nh `write` sáº½ pháº£i ghi O (N), vá»›i N = Ä‘á»™ sÃ¢u trong há»‡ thá»‘ng phÃ¢n cáº¥p thÆ° má»¥c
 * Lá»‡nh `remove` loáº¡i bá» tá»‡p chá»‰ thá»‹ tÆ°Æ¡ng á»©ng vÃ  tá»‡p cha cá»§a nÃ³ náº¿u trá»‘ng, má»™t cÃ¡ch Ä‘á»‡ quy; sau Ä‘Ã³ xÃ³a tá»‡p
 * CÃ¡c lá»‡nh `remove` khÃ´ng Ä‘á»‡ quy sáº½ pháº£i chá»‹u O (N) láº§n Ä‘á»c vÃ  cÃ³ kháº£ nÄƒng lÃ  nhiá»u láº§n xÃ³a, vá»›i N = Ä‘á»™ sÃ¢u trong phÃ¢n cáº¥p thÆ° má»¥c
 * CÃ¡c lá»‡nh `remove` Ä‘á»‡ quy trÃªn cÃ¡c há»‡ thá»‘ng tá»‡p lá»›n vÃ  sÃ¢u cÃ³ thá»ƒ tá»‘n kÃ©m

 LÆ°u Ã½ ráº±ng ngay cáº£ khi kÃ­ch hoáº¡t mÃ£ hÃ³a phÃ­a mÃ¡y khÃ¡ch, káº» thÃ¹ váº«n cÃ³ kháº£ nÄƒng hiá»ƒn thá»‹ Ä‘áº§y Ä‘á»§ phÃ­a mÃ¡y chá»§ Ä‘Æ°á»£c mÃ£ hÃ³a cá»§a báº¡n
 bá»™ nhá»›, ngay cáº£ khi khÃ´ng cÃ³ khÃ³a, váº«n cÃ³ thá»ƒ xem tá»•ng sá»‘ thÆ° má»¥c vÃ  bao nhiÃªu tá»‡p trong má»—i thÆ° má»¥c vÃ  vá»›i
 má»™t sá»‘ ná»— lá»±c, khÃ¡m phÃ¡ má»™t sá»‘ hoáº·c táº¥t cáº£ cáº¥u trÃºc tá»•ng thá»ƒ cá»§a há»‡ thá»‘ng phÃ¢n cáº¥p thÆ° má»¥c.
 * LÆ°u Ã½: Sá»­ dá»¥ng cáº¥u trÃºc tÆ°Æ¡ng Ä‘á»‘i pháº³ng Ä‘á»ƒ báº£o máº­t tá»‘t hÆ¡n. *
 Äá»‘i thá»§ sáº½ khÃ´ng biáº¿t tÃªn cá»§a cÃ¡c thÆ° má»¥c / tá»‡p trá»« khi há» cÅ©ng biáº¿t mÃ£ hÃ³a cá»§a báº¡n
 hoáº·c Ä‘Ã£ báº» khÃ³a mÃ£ hÃ³a thÃ nh cÃ´ng. Táº¥t cáº£ cÃ¡c cÆ°á»£c Ä‘Ã£ táº¯t sau Ä‘Ã³!

 ### Hiá»‡u suáº¥t vÃ  bá»™ nhá»› Ä‘á»‡m
 CÃ¡c hoáº¡t Ä‘á»™ng trÃªn bá»™ nhá»› Ä‘Æ°á»£c mÃ£ hÃ³a cÃ³ thá»ƒ bá»‹ cháº­m. Danh sÃ¡ch Ä‘á»‡ quy vÃ  xÃ³a cÃ³ thá»ƒ ráº¥t cháº­m.
 Bá»™ nhá»› Ä‘á»‡m thÃ´ng qua redis giÃºp Ã­ch ráº¥t nhiá»u, nhÆ°ng lÆ°u Ã½ ráº±ng bá»™ nhá»› Ä‘á»‡m Ä‘Æ°á»£c xÃ³a khi báº¥t ká»³ láº§n ghi hoáº·c xÃ³a nÃ o.

 ## Xoay phÃ­m
 Táº¡o má»™t mobiletto báº±ng khÃ³a má»›i cá»§a báº¡n, sau Ä‘Ã³ sao chÃ©p dá»¯ liá»‡u cÅ© vÃ o Ä‘Ã³:

    const storage = require('mobiletto')

    const oldEncryption = { key: .... }
    const oldStorage = await storage.connect('s3', aws_key, aws_secret, {bucket: 'bk', region: 'us-east-1'}, oldEncryption)

    const newEncryption = { key: .... }
    const newStorage = await storage.connect('s3', aws_key, aws_secret, {bucket: 'zz', region: 'us-east-1'}, newEncryption)

    newStorage.mirror(oldStorage) // if oldStorage is very large, this may take a looooooong time...

 ## Giao diá»‡n trÃ¬nh Ä‘iá»u khiá»ƒn
 TrÃ¬nh Ä‘iá»u khiá»ƒn lÃ  báº¥t ká»³ tá»‡p JS nÃ o xuáº¥t má»™t hÃ m 'storageClient' vá»›i chá»¯ kÃ½ nÃ y:

    function storageClient (key, secret, opts)

 * `key` : má»™t chuá»—i, khÃ³a API cá»§a báº¡n (Ä‘á»‘i vá»›i trÃ¬nh Ä‘iá»u `local` , Ä‘Ã¢y lÃ  thÆ° má»¥c cÆ¡ sá»Ÿ)
 * `secret` : má»™t chuá»—i, bÃ­ máº­t API cá»§a báº¡n (cÃ³ thá»ƒ Ä‘Æ°á»£c bá» qua cho trÃ¬nh Ä‘iá»u `local` )
 * `opts` : má»™t Ä‘á»‘i tÆ°á»£ng, cÃ¡c thuá»™c tÃ­nh lÃ  trÃªn má»—i trÃ¬nh Ä‘iá»u khiá»ƒn:
 * Äá»‘i vá»›i `local` , thuá»™c `fileMode` vÃ  `dirMode` xÃ¡c Ä‘á»‹nh cÃ¡ch táº¡o cÃ¡c tá»‡p vÃ  thÆ° má»¥c má»›i Ä‘Æ°á»£c táº¡o
 * Äá»‘i vá»›i `s3` , thuá»™c `bucket` lÃ  báº¯t buá»™c. CÃ¡c thuá»™c tÃ­nh tÃ¹y chá»n lÃ :
    * `region`: the S3 region, default is us-east-1
    * `prefix`: a prefix to prepend to all S3 paths, default is the empty string
    * `delimiter`: the directory delimiter, default is '/'

 Äá»‘i tÆ°á»£ng mÃ  hÃ m StorageClient tráº£ vá» pháº£i xÃ¡c Ä‘á»‹nh cÃ¡c hÃ m nÃ y:

    // Test the driver before using, ensure proper configuration
    async testConfig ()

    // List files in path (or from base-directory)
    // If recursive is true, list recursively
    // If visitor is defined, it will be an async function. await the visitor function on each file found
    // Otherwise, perform the listing and return an array of objects
    async list (path, recursive = false, visitor = null) // path may be omitted
    
    // Read metadata for a path
    async metadata (path)
    
    // Read a file
    // callback receives a chunk of data. endCallback is called at end-of-stream
    async read (path, callback, endCallback = null)

    // Write a file
    // driver must be able to handle a generator or a stream
    async write (path, generatorOrReadableStream)

    // Remove a file, or recursively delete a directory
    // returns a string of a single path removed, or an array of multiple paths removed
    async remove (path, recursive = false, quiet = false)

 ## Ghi nháº­t kÃ½
 Mobiletto sá»­ dá»¥ng thÆ° viá»‡n ghi nháº­t kÃ½ [wonton](https://www.npmjs.com/package/winston).

 Nháº­t kÃ½ ** sáº½ ** chá»©a Ä‘Æ°á»ng dáº«n tá»‡p vÃ  thÃ´ng bÃ¡o lá»—i, nhÆ°ng sáº½ ** khÃ´ng bao giá» ** chá»©a khÃ³a, bÃ­ máº­t,
 hoáº·c báº¥t ká»³ thÃ´ng tin cáº¥u hÃ¬nh káº¿t ná»‘i nÃ o khÃ¡c.

 ### Má»©c Ä‘Äƒng nháº­p
 Sá»­ dá»¥ng biáº¿n mÃ´i trÆ°á»ng `MOBILETTO_LOG_LEVEL` Ä‘á»ƒ Ä‘áº·t má»©c nháº­t kÃ½, sá»­ dá»¥ng má»™t
 cá»§a cÃ¡c cáº¥p Ä‘á»™ `npm` Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh trong [https://www.npmjs.com/package/winston#logging-levels](https://www.npmjs.com/package/winston#logging-levels)

 Má»©c máº·c Ä‘á»‹nh lÃ  `error` . Má»©c Ä‘á»™ dÃ i dÃ²ng nháº¥t lÃ  `silly` , máº·c dÃ¹ hiá»‡n táº¡i lÃ  mobiletto
 khÃ´ng Ä‘Äƒng nháº­p á»Ÿ cÃ¡c cáº¥p dÆ°á»›i `debug`

    MOBILETTO_LOG_LEVEL=silly # maximum logs!

 ### Tá»‡p nháº­t kÃ½
 Theo máº·c Ä‘á»‹nh, trÃ¬nh ghi nháº­t kÃ½ ghi vÃ o báº£ng Ä‘iá»u khiá»ƒn. Äá»ƒ gá»­i nháº­t kÃ½ vÃ o má»™t tá»‡p, hÃ£y Ä‘áº·t `MOBILETTO_LOG_FILE`
 biáº¿n mÃ´i trÆ°á»ng. Khi Ä‘Äƒng nháº­p vÃ o má»™t tá»‡p, nháº­t kÃ½ sáº½ khÃ´ng cÃ²n Ä‘Æ°á»£c ghi vÃ o báº£ng Ä‘iá»u khiá»ƒn.

    MOBILETTO_LOG_FILE=/var/my_mobiletto_log

 Äá»ƒ táº¯t ghi nháº­t kÃ½:

    MOBILETTO_LOG_FILE=/dev/null

</pre>
